/* Mobile / Slide-out Menu Styles
   Applied to all screen sizes as requested.
   Includes hamburger toggle, drawer, backdrop, and animations.
*/

/* 1. Hamburger Toggle (Always Visible) */
.menu-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  right: 12px; /* Reduced from 20px for better spacing on mobile */
  top: 50%;
  transform: translateY(-50%);
  background: transparent;
  border: none;
  padding: 10px;
  cursor: pointer;
  z-index: 60;
  min-width: 44px; /* Touch-friendly size */
  min-height: 44px;
  border-radius: 4px;
  transition: background-color 0.2s ease;
}

.menu-toggle:hover,
.menu-toggle:active {
  background-color: rgba(255, 255, 255, 0.1);
}

@media (max-width: 768px) {
  .menu-toggle {
    right: 14px;
    padding: 8px;
    z-index: 70; /* Higher than header-center and user section */
  }
  
  /* Ensure hamburger is always visible and accessible */
  body.homepage .menu-toggle {
    right: 14px;
  }
}

@media (max-width: 480px) {
  .menu-toggle {
    right: 12px;
    padding: 6px;
    min-width: 40px;
    min-height: 40px;
    z-index: 70; /* Higher than header-center and user section */
  }
  
  /* Ensure hamburger is always visible and accessible */
  body.homepage .menu-toggle {
    right: 12px;
  }
}

.menu-toggle:focus-visible {
  outline: 3px solid rgba(3,120,255,0.16);
  outline-offset: 4px;
  border-radius: 4px;
}

.menu-toggle .hamburger {
  display: block;
  width: 24px;
  height: 2px;
  background: #ffffff; /* White to match header text color */
  position: relative;
}

/* Ensure hamburger is visible against header background */
.menu-toggle .hamburger,
.menu-toggle .hamburger::before,
.menu-toggle .hamburger::after {
  background: #ffffff; 
}

.menu-toggle .hamburger::before,
.menu-toggle .hamburger::after {
  content: '';
  position: absolute;
  left: 0;
  width: 24px;
  height: 2px;
  background: inherit;
  transition: transform 180ms ease, opacity 180ms ease;
}

.menu-toggle .hamburger::before { top: -8px; }
.menu-toggle .hamburger::after { top: 8px; }


/* 2. Slide-out Drawer (Always enabled) */
.mobile-menu {
  position: fixed;
  top: 0;
  right: 0;
  left: auto;
  bottom: 0;
  width: 300px;
  max-width: 85vw;
  background: #ffffff;
  z-index: 70; /* Higher than header */
  box-shadow: -10px 0 30px rgba(2,6,23,0.18);
  padding: 60px 20px 20px 20px; /* Top padding for close button area */
  display: flex;
  flex-direction: column;
  gap: 10px;
  
  transform: translateX(100%); /* Hidden by default */
  opacity: 1; /* Always opaque when visible */
}

/* Drawer Open/Close Animations */
header.site-header.open #mobile-menu {
  animation: drawerIn 320ms cubic-bezier(.2,.9,.2,1) forwards;
}
header.site-header:not(.open) #mobile-menu {
  animation: drawerOut 240ms cubic-bezier(.2,.9,.2,1) forwards; /* Only plays when closing if class was present */
  /* Note: On initial load without 'open' class, this might run. 
     Usually acceptable, or we can rely on JS to handle initial state. */
}

/* 3. Backdrop Overlay */
.mobile-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(2,6,23,0.45);
  z-index: 65; /* Below menu, above everything else */
  opacity: 0;
  pointer-events: none;
}

header.site-header.open + .mobile-backdrop,
.mobile-backdrop.open {
  display: block;
  animation: overlayFadeIn 240ms ease forwards;
  pointer-events: auto;
}

header.site-header:not(.open) + .mobile-backdrop {
  animation: overlayFadeOut 200ms ease forwards;
}


/* 4. Close Button inside Drawer */
.mobile-menu .close-btn {
  position: absolute;
  top: 16px;
  right: 16px;
  background: rgba(6,56,90,0.06);
  color: #06385a;
  border: 1px solid rgba(6,56,90,0.09);
  border-radius: 8px;
  width: 36px;
  height: 36px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  cursor: pointer;
  z-index: 72;
}

.mobile-menu .close-btn:hover {
  background: rgba(6,56,90,0.1);
}

/* 5. Pill Buttons adaptation for Drawer */
/* Overriding styles.css .nav-btn specifically for the drawer context */
.mobile-menu .nav-btn {
  display: flex;
  width: 100%;
  max-width: none; /* Override the 140px limit */
  justify-content: flex-start; /* Align left */
  height: auto;
  padding: 12px 16px;
  margin-bottom: 8px;
  font-size: 1.05rem;
  background: #f8fbff;
  border: 1px solid rgba(6,56,90,0.08);
}

.mobile-menu .nav-btn:hover {
  background: #eef6fb;
  transform: translateX(-2px); /* Slight left nudge instead of up */
}

.mobile-menu .nav-btn .nav-label {
  display: inline-block; /* Ensure label is always shown */
  margin-left: 12px;
}

.mobile-menu .nav-btn .nav-icon {
  width: 20px;
  height: 20px;
  flex: 0 0 20px;
}


/* Keyframes */
@keyframes overlayFadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}
@keyframes overlayFadeOut {
  from { opacity: 1; }
  to   { opacity: 0; }
}
@keyframes drawerIn {
  from { transform: translateX(100%); }
  to   { transform: translateX(0); }
}
@keyframes drawerOut {
  from { transform: translateX(0); }
  to   { transform: translateX(100%); }
}

/* User profile section positioning on header (desktop, right-aligned) */
header.site-header > div[style*="position: absolute; right: 90px"] {
  display: flex;
}

/* Hide user profile on mobile/tablet to prevent overlap with hamburger */
@media (max-width: 900px) {
  header.site-header > div[style*="position: absolute; right: 90px"] {
    display: none;
  }
}

/* Touch-friendly button sizes (minimum 44x44px) */
button, .btn, .btn-primary, .btn-outline, a.button, input[type="submit"], input[type="button"] {
  min-height: 44px;
  min-width: 44px;
  padding: 12px 20px;
  touch-action: manipulation; /* Prevents double-tap zoom delay */
}

/* Improve touch targets for small buttons */
.btn-sm {
  min-height: 36px;
  min-width: 36px;
  padding: 8px 16px;
}

/* Better spacing for mobile */
@media (max-width: 768px) {
  button, .btn {
    padding: 14px 24px; /* Larger padding on mobile */
    font-size: 16px; /* Prevents iOS zoom on focus */
  }
  
  /* Adequate spacing between clickable elements */
  a, button, input, select, textarea {
    margin-bottom: 12px;
  }
  
  /* Prevent accidental text selection on buttons */
  button, .btn {
    -webkit-user-select: none;
    user-select: none;
  }
}

/* Additional breakpoints */
@media (max-width: 480px) {
  .mobile-menu {
    width: 280px;
    max-width: 90vw;
  }
  
  button, .btn {
    width: 100%; /* Full-width buttons on very small screens */
    margin-bottom: 10px;
  }
}

@media (max-width: 320px) {
  .mobile-menu {
    width: 100vw;
  }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
   .mobile-menu,
   .mobile-backdrop,
   .menu-toggle .hamburger::before,
   .menu-toggle .hamburger::after {
     animation: none !important;
     transition: none !important;
   }
}

/* Prevent double-tap zoom on buttons and links */
a, button, input, select, textarea {
  touch-action: manipulation;
}

/* Improve scrolling on mobile */
html {
  -webkit-overflow-scrolling: touch;
  overflow-scrolling: touch;
}
